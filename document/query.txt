----------------------------------------------코드---------------------------------------------

CREATE TABLE CODE (
	CATEGORY VARCHAR2(30) NOT NULL,
	DIV NUMBER(5) NOT NULL,
	DIV_NAME VARCHAR2(100) NOT NULL,
	SEQ NUMBER(3) NOT NULL,
	USE_YN CHAR(1) NOT NULL
);

COMMENT ON TABLE CODE IS '코드';

COMMENT ON COLUMN CODE.CATEGORY IS '항목';

COMMENT ON COLUMN CODE.DIV IS '구분';

COMMENT ON COLUMN CODE.DIV_NAME IS '상세네임';

COMMENT ON COLUMN CODE.SEQ IS '순번';

COMMENT ON COLUMN CODE.USE_YN IS '사용여부';

CREATE UNIQUE INDEX PK_CODE
	ON CODE (
		CATEGORY ASC,
		DIV ASC
	);

ALTER TABLE CODE
	ADD
		CONSTRAINT PK_CODE
		PRIMARY KEY (
			CATEGORY,
			DIV
		);

------------------------------------------------유저-----------------------------------------

CREATE SEQUENCE users_seq
MINVALUE 1
START WITH 1
INCREMENT BY 1
CACHE 10
NOCYCLE;

CREATE TABLE USERS (
	ID VARCHAR2(20) NOT NULL,
	NO NUMBER(8) DEFAULT users_seq.NEXTVAL,
	PW VARCHAR2(20) NOT NULL,
	EMAIL VARCHAR2(320) NOT NULL,
	NAME VARCHAR2(30) NOT NULL,
	BIRTH NUMBER(6) NOT NULL,
	GENDER NUMBER(1) NOT NULL,
	HEIGHT NUMBER(4,1) NOT NULL,
	WEIGHT NUMBER(4,1) NOT NULL,
	REG_DT DATE DEFAULT SYSDATE,
	USER_FILTER NUMBER(1) DEFAULT 2
);

COMMENT ON TABLE USERS IS '유저';

COMMENT ON COLUMN USERS.ID IS '아이디';

COMMENT ON COLUMN USERS.NO IS '유저번호';

COMMENT ON COLUMN USERS.PW IS '비밀번호';

COMMENT ON COLUMN USERS.EMAIL IS '이메일';

COMMENT ON COLUMN USERS.NAME IS '이름';

COMMENT ON COLUMN USERS.BIRTH IS '생년월일';

COMMENT ON COLUMN USERS.GENDER IS '성별';

COMMENT ON COLUMN USERS.HEIGHT IS '키';

COMMENT ON COLUMN USERS.WEIGHT IS '몸무게';

COMMENT ON COLUMN USERS.REG_DT IS '등록일자';

COMMENT ON COLUMN USERS.USER_FILTER IS '사용자구분';

CREATE UNIQUE INDEX PK_USERS
	ON USERS (
		ID ASC
	);

ALTER TABLE USERS
	ADD
		CONSTRAINT PK_USERS
		PRIMARY KEY (
			ID
		);
		
--------------------------------------------영양소----------------------------------------

CREATE TABLE NUTRIENT (
	CODE CHAR(19) NOT NULL,
	NAME VARCHAR2(120) NOT NULL,
	NORM NUMBER(3) NOT NULL,
	KCAL NUMBER(4) NOT NULL,
	CARBOHYDRATE NUMBER(6,3) NOT NULL,
	PROTEIN NUMBER(6,3) NOT NULL,
	FAT NUMBER(6,3) NOT NULL,
	SUGARS NUMBER(6,3) NOT NULL,
	WEIGHT NUMBER(4) NOT NULL
);

COMMENT ON TABLE NUTRIENT IS '영양소';

COMMENT ON COLUMN NUTRIENT.CODE IS '식품코드';

COMMENT ON COLUMN NUTRIENT.NAME IS '식품명';

COMMENT ON COLUMN NUTRIENT.NORM IS '기준량';

COMMENT ON COLUMN NUTRIENT.KCAL IS '에너지';

COMMENT ON COLUMN NUTRIENT.CARBOHYDRATE IS '탄수화물';

COMMENT ON COLUMN NUTRIENT.PROTEIN IS '단백질';

COMMENT ON COLUMN NUTRIENT.FAT IS '지방';

COMMENT ON COLUMN NUTRIENT.SUGARS IS '당류';

COMMENT ON COLUMN NUTRIENT.WEIGHT IS '중량';

CREATE UNIQUE INDEX PK_NUTRIENT
	ON NUTRIENT (
		CODE ASC
	);

ALTER TABLE NUTRIENT
	ADD
		CONSTRAINT PK_NUTRIENT
		PRIMARY KEY (
			CODE
		);
		
---------------------------------------------EAT-------------------------------------------

CREATE TABLE EAT (
	ID VARCHAR2(20) NOT NULL,
	REG_DT DATE DEFAULT SYSDATE,
	CODE CHAR(19) NOT NULL
);

COMMENT ON TABLE EAT IS '섭취량';

COMMENT ON COLUMN EAT.ID IS '아이디';

COMMENT ON COLUMN EAT.REG_DT IS '등록일';

COMMENT ON COLUMN EAT.CODE IS '식품코드';

CREATE UNIQUE INDEX PK_EAT
	ON EAT (
		ID ASC,
		REG_DT ASC,
        CODE ASC
	);

ALTER TABLE EAT
	ADD
		CONSTRAINT PK_EAT
		PRIMARY KEY (
			ID,
			REG_DT,
            CODE
		);

ALTER TABLE EAT
	ADD
		CONSTRAINT FK_USERS_TO_EAT
		FOREIGN KEY (
			ID
		)
		REFERENCES USERS (
			ID
		) ON DELETE CASCADE;

ALTER TABLE EAT
	ADD
		CONSTRAINT FK_NUTRIENT_TO_EAT
		FOREIGN KEY (
			CODE
		)
		REFERENCES NUTRIENT (
			CODE
		) ON DELETE CASCADE;
		
----------------------------------------------공지사항----------------------------------------

CREATE SEQUENCE notice_seq
MINVALUE 1
START WITH 1
INCREMENT BY 1
CACHE 10
NOCYCLE;

CREATE TABLE NOTICE (
	POST_NO NUMBER DEFAULT notice_seq.NEXTVAL,
	TITLE VARCHAR2(300) NOT NULL,
	CONTENTS CLOB NOT NULL,
	REG_DT DATE DEFAULT SYSDATE,
	READ_CNT NUMBER,
	ID VARCHAR2(20) NOT NULL
);

COMMENT ON TABLE NOTICE IS '공지사항';

COMMENT ON COLUMN NOTICE.POST_NO IS '게시순서';

COMMENT ON COLUMN NOTICE.TITLE IS '제목';

COMMENT ON COLUMN NOTICE.CONTENTS IS '내용';

COMMENT ON COLUMN NOTICE.REG_DT IS '등록일';

COMMENT ON COLUMN NOTICE.READ_CNT IS '조회수';

COMMENT ON COLUMN NOTICE.ID IS '아이디';

CREATE UNIQUE INDEX PK_NOTICE
	ON NOTICE (
		POST_NO ASC
	);

ALTER TABLE NOTICE
	ADD
		CONSTRAINT PK_NOTICE
		PRIMARY KEY (
			POST_NO
		);

ALTER TABLE NOTICE
	ADD
		CONSTRAINT FK_USERS_TO_NOTICE
		FOREIGN KEY (
			ID
		)
		REFERENCES USERS (
			ID
		) ON DELETE CASCADE;
		
----------------------------------------자유게시판---------------------------------

CREATE SEQUENCE bulletin_seq
MINVALUE 1
START WITH 1
INCREMENT BY 1
CACHE 10
NOCYCLE;

CREATE TABLE BULLETIN (
	POST_NO NUMBER DEFAULT bulletin_seq.NEXTVAL,
	TITLE VARCHAR2(300) NOT NULL,
	CONTENTS CLOB NOT NULL,
	REG_DT DATE DEFAULT SYSDATE,
	MOD_DT DATE,
	READ_CNT NUMBER,
	ID VARCHAR2(20) NOT NULL,
	MOD_ID VARCHAR2(20)
);

COMMENT ON TABLE BULLETIN IS '자유게시판';

COMMENT ON COLUMN BULLETIN.POST_NO IS '게시순서';

COMMENT ON COLUMN BULLETIN.TITLE IS '제목';

COMMENT ON COLUMN BULLETIN.CONTENTS IS '내용';

COMMENT ON COLUMN BULLETIN.REG_DT IS '등록일';

COMMENT ON COLUMN BULLETIN.MOD_DT IS '수정일';

COMMENT ON COLUMN BULLETIN.READ_CNT IS '조회수';

COMMENT ON COLUMN BULLETIN.ID IS '아이디';

COMMENT ON COLUMN BULLETIN.MOD_ID IS '수정자';

CREATE UNIQUE INDEX PK_BULLETIN
	ON BULLETIN (
		POST_NO ASC
	);

ALTER TABLE BULLETIN
	ADD
		CONSTRAINT PK_BULLETIN
		PRIMARY KEY (
			POST_NO
		);

ALTER TABLE BULLETIN
	ADD
		CONSTRAINT FK_USERS_TO_BULLETIN
		FOREIGN KEY (
			ID
		)
		REFERENCES USERS (
			ID
		) ON DELETE CASCADE;
		
--------------------------------------------뉴스---------------------------------

CREATE SEQUENCE news_seq
MINVALUE 1
START WITH 1
INCREMENT BY 1
CACHE 10
NOCYCLE;

CREATE TABLE NEWS (
	POST_NO NUMBER DEFAULT news_seq.NEXTVAL,
	TITLE VARCHAR2(300) NOT NULL,
	CONTENTS CLOB NOT NULL,
	REG_DT DATE DEFAULT SYSDATE,
	READ_CNT NUMBER,
	ID VARCHAR2(20) NOT NULL
);

COMMENT ON TABLE NEWS IS '뉴스';

COMMENT ON COLUMN NEWS.POST_NO IS '게시순서';

COMMENT ON COLUMN NEWS.TITLE IS '제목';

COMMENT ON COLUMN NEWS.CONTENTS IS '내용';

COMMENT ON COLUMN NEWS.REG_DT IS '등록일';

COMMENT ON COLUMN NEWS.READ_CNT IS '조회수';

COMMENT ON COLUMN NEWS.ID IS '아이디';

CREATE UNIQUE INDEX PK_NEWS
	ON NEWS (
		POST_NO ASC
	);

ALTER TABLE NEWS
	ADD
		CONSTRAINT PK_NEWS
		PRIMARY KEY (
			POST_NO
		);

ALTER TABLE NEWS
	ADD
		CONSTRAINT FK_USERS_TO_NEWS
		FOREIGN KEY (
			ID
		)
		REFERENCES USERS (
			ID
		) ON DELETE CASCADE;
		
--------------------------------------------댓글---------------------------------------

CREATE SEQUENCE comments_seq
MINVALUE 1
START WITH 1
INCREMENT BY 1
CACHE 10
NOCYCLE;

CREATE TABLE COMMENTS (
	REG_NO NUMBER DEFAULT comments_seq.NEXTVAL,
	CONTENTS VARCHAR2(300) NOT NULL,
	REG_DT DATE DEFAULT SYSDATE,
	POST_NO NUMBER NOT NULL,
	ID VARCHAR2(20) NOT NULL,
	MOD_ID VARCHAR2(20)
);

COMMENT ON TABLE COMMENTS IS '댓글';

COMMENT ON COLUMN COMMENTS.REG_NO IS '등록순서';

COMMENT ON COLUMN COMMENTS.CONTENTS IS '내용';

COMMENT ON COLUMN COMMENTS.REG_DT IS '등록일';

COMMENT ON COLUMN COMMENTS.POST_NO IS '게시순서';

COMMENT ON COLUMN COMMENTS.ID IS '아이디';

COMMENT ON COLUMN COMMENTS.MOD_ID IS '수정자';

CREATE UNIQUE INDEX PK_COMMENTS
	ON COMMENTS (
		REG_NO ASC
	);

ALTER TABLE COMMENTS
	ADD
		CONSTRAINT PK_COMMENTS
		PRIMARY KEY (
			REG_NO
		);

ALTER TABLE COMMENTS
	ADD
		CONSTRAINT FK_BULLETIN_TO_COMMENTS
		FOREIGN KEY (
			POST_NO
		)
		REFERENCES BULLETIN (
			POST_NO
		) ON DELETE CASCADE;

ALTER TABLE COMMENTS
	ADD
		CONSTRAINT FK_USERS_TO_COMMENTS
		FOREIGN KEY (
			ID
		)
		REFERENCES USERS (
			ID
		) ON DELETE CASCADE;
		
----------------------------------------------이미지---------------------------------------

CREATE TABLE IMAGE (
	UUID VARCHAR2(45) NOT NULL,
	SEQ NUMBER(2),
	ORG_FILE_NAME VARCHAR2(300),
	SAVE_FILE_NAME VARCHAR2(100),
	EXTENSION VARCHAR2(5),
	FILE_SIZE NUMBER(8),
	SAVE_PATH VARCHAR2(80),
	REG_DT DATE DEFAULT SYSDATE,
	REG_ID VARCHAR2(20)
);

COMMENT ON TABLE IMAGE IS '이미지';

COMMENT ON COLUMN IMAGE.UUID IS 'UUID';

COMMENT ON COLUMN IMAGE.SEQ IS '순번';

COMMENT ON COLUMN IMAGE.ORG_FILE_NAME IS '원본파일명';

COMMENT ON COLUMN IMAGE.SAVE_FILE_NAME IS '저장파일명';

COMMENT ON COLUMN IMAGE.EXTENSION IS '확장자';

COMMENT ON COLUMN IMAGE.FILE_SIZE IS '사이즈';

COMMENT ON COLUMN IMAGE.SAVE_PATH IS '저장경로';

COMMENT ON COLUMN IMAGE.REG_DT IS '등록일';

COMMENT ON COLUMN IMAGE.REG_ID IS '등록자';

CREATE UNIQUE INDEX PK_IMAGE
	ON IMAGE (
		UUID ASC
	);

ALTER TABLE IMAGE
	ADD
		CONSTRAINT PK_IMAGE
		PRIMARY KEY (
			UUID
		);